name: Generate HTML file

on:
  push:
    branches:
      - fix-deploy-2

jobs:
  Deploy:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@c85c95e3d7251135ab7dc9ce3241c5835cc595a9 # v3.5.3

      - uses: actions/setup-python@e797f83bcb11b83ae66e0230d6156d7c80228e7c # v6.0.0
        with:
          python-version: "3.12"

      - uses: actions/setup-node@a0853c24544627f65ddf259abe73b1d18a591444 # v5.0.0
        with:
          node-version: 22

      - uses: pnpm/action-setup@a7487c7e89a18df4991f7f222e4898a00d66ddda # v4.1.0
        with:
          version: 9

      - name: Install JS dependencies
        run: pnpm install

      # Run pre-commit --all-files
      - uses: pre-commit/action@646c83fcd040023954eafda54b4db0192ce70507 # v3.0.0

      - name: Build project
        run: pnpm build

      - name: Prepare dist dir
        run: mkdir dist && cp build/index.html dist/index.html

      # - name: Push result into a dist branch
      #   if: success()
      #   run: |
      #     SRC="$(pwd)"
      #     mkdir /tmp/github-dist && cd /tmp/github-dist
      #     git init . && git checkout --orphan "${BRANCH}"
      #     cp -r "${SRC}/${DEPLOY_DIR}"/* .

      #     git config user.name "GitHub" && git config user.email "<noreply@github.com>"
      #     git add . && git status && git commit --message "${MESSAGE}"
      #     git push -f -q "https://x-access-token:${GITHUB_TOKEN}@github.com/${GITHUB_REPOSITORY}.git" "${BRANCH}"
      #   env:
      #     DEPLOY_DIR: dist
      #     MESSAGE: Compile HTML file
      #     BRANCH: dist
      #     GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
